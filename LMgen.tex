
\def\anon{1} %% set to 1 for anonymous submissions, hides acknowledgments and author names
\def\full{1} %% set to 0 for springer proceedings



\documentclass{llncs}

\pagestyle{plain}

\input{header.tex}

\begin{document}

	\title{Weightwise Almost Perfectly Balanced functions, constructions from a group action view.}
		
		%Working Document: Weightwise Almost Perfectly Balanced Functions generalizing the Liu-Mensager Construction}

\ifnum\anon=0
\author{
	Deepak Kumar Dalai\inst{1}\\
	Krishna Mallick\inst{2}\\
	Pierrick M\'eaux\orcidID{0000-0001-5733-4341}\inst{3}
}
\authorrunning{ D. Dalai, K. Mallick, P. M\'eaux}

\institute{
	School of Mathematical Sciences,
	National Institute of Science Education and Research, HBNI,
	Bhubaneswar, Odisha 752050, India.\\
	\email{deepak@niser.ac.in}
		\and
	School of Computer Sciences,
	National Institute of Science Education and Research, HBNI,
	Bhubaneswar, Odisha 752050, India.\\
	\email{krishna.mallick@niser.ac.in}
\and  University of Luxembourg, Luxembourg\\
\email{pierrick.meaux@uni.lu}
}

\fi
	

	
	%----------------------------------------------------------------
	\maketitle


\setcounter{page}{1}	

\begin{abstract}
 	\end{abstract}
 
 
\section{Introduction} 
\section{Preliminaries}

	
	

\section{Construction with half orbits}\label{sec:half}

Generalization of LM construction based on group action, taking half of each orbit of even cardinal, and the alternatively the floor or ceiling of half of each orbit of odd cardinal. See Construction~\ref{Alg:WAPBconst}.

\begin{figure}[H]
	\begin{algorithmic}[1]			
		\Require $v\in \{-1,0,1\}^{n+1}$ % with $v_k \equiv \pm (\binom{n}{k} \mod 2)$.
		\Require $\alpha \in \Sn$. One representative $r_{k,i}$ of each orbit of the action of $<\alpha>$ on $\Ekn{k}{n}$. $s_k$ the number of orbits of $\Ekn{k}{n}$.
		\Ensure  $f\in \WAPB{n}$.
		\State Initiate $\supp(f)=\emptyset$ \;
		\For{$k \gets 0$ to $n$}
			\For{$i \gets 1$ to $s_k$}
				\State $u=r_{k,i}$ \;
				\State Compute $\ell=|\orb_{\alpha}(r_{k,i})|$ \;
				\For{$j \gets 1$ to $(\ell+v_k)/2$}
					\State  $\supp(f)$.append($u$)\;
					\State  $u \gets \alpha \circ \alpha \ltimes u$\;
					\State $v_k\gets -v_k$ \;
				\EndFor
			\EndFor		
		\EndFor	
		\State  \Return $f$
	\end{algorithmic}
\caption{WAPB Construction~\label{Alg:WAPBconst}}
\end{figure}


We consider Construction~\ref{Alg:WAPBconst} with $n=2^{a_1}+2^{a_2}+\ldots +2^{a_w}$ where $0\le a_1<a_2<\ldots <a_w$ and denote $n_1=2^{a_1},\ldots, n_w=2^{a_w}$ and:
\[\alpha=(x_1,x_2,\ldots,x_{n_1}) (x_{n_1+1},\ldots,x_{n_1+n_2})\ldots  (x_{n-n_1+1},\ldots,x_n).\] 
We denote $f_n$ this construction.


\begin{proposition}
	
Let $n\in \N$, $n\ge 2$, $f_n$ satisfies $\NL(f_n)\ge 2^{n-2} - 2^{n-n_w}$.	
	
	
	
	
\end{proposition}
\begin{proof}
	Let denote $x\in \F_2^n$ as $(y,z)$ where $y\in \F_2^{n-n_w}$ and $z \in \F_2^{n_w}$.

We determine the Walsh transform of $f$ in $a$, $\wt{f}(a)$ for $a\in \F_2^n$, $a=(b,c)$ with $b\in  \F_2^{n-n_w}$ and $z \in \F_2^{n_w}$.

%\begin{align*}
%\wt{f}(a)&=\sum_{x\in \F_2^n} (-1)^{f(x)+a x}\\
%&=\sum_{i=1}^{t} \sum_{z\in O_i} \sum_{y\in \F_2^{n-n_w}}(-1)^{f(y,z)+by+cz} + \sum_{i=t+1}^{t+s} \sum_{z\in O_i} \sum_{y\in \F_2^{n-n_w}}(-1)^{f(y,z)+by+cz},\\
%\end{align*}	
\begin{equation}\label{eq:wt}
\wt{f}(a)=\sum_{x\in \F_2^n} (-1)^{f(x)+a x}\\
=\sum_{i=1}^{t} \sum_{z\in O_i} \sum_{y\in \F_2^{n-n_w}}(-1)^{f(y,z)+by+cz} + \sum_{i=t+1}^{t+s} \sum_{z\in O_i} \sum_{y\in \F_2^{n-n_w}}(-1)^{f(y,z)+by+cz},\\
\end{equation}	
where we denote $O_1$ to $O_t$ the $t$ even-length orbits of $\F_2^{n_w}$ (relatively to $<(x_{1},\ldots,x_{n_w})>$) and $O_{t+1}$ to $O_{t+s}$ the odd-length ones.  
	
Since $n_w$ is a power of two, $s=2$, the only orbits of odd lengths are the ones of $0_{n_w}$ and  $1_{n_w}$. Thereafter we can derive the following bound on the second sum of Equation~\ref{eq:wt}:
%$\[|\sum_{i=t+1}^{t+s} \sum_{z\in O_i} \sum_{y\in \F_2^{n-n_w}}(-1)^{f(y,z)+by+cz}| \le  |\sum_{z\in \{0_{n_w}, 1_{n_w}\}} \sum_{y\in \F_2^{n-n_w}}(-1)^{f(y,z)+by+cz}|\]$

\[|\sum_{i=t+1}^{t+s} \sum_{z\in O_i} \sum_{y\in \F_2^{n-n_w}}(-1)^{f(y,z)+by+cz}|= |\sum_{z\in \{0_{n_w},1_{n_w}\}} \sum_{y\in \F_2^{n-n_w}}(-1)^{f(y,z)+by+cz}|\le 2^{n-n_w+1}
\]

Then, we look for a bound for the first sum of Equation~\ref{eq:wt}. We denote $\pi_w=(x_{1},\ldots,x_{n_w})$.

\begin{align*}
\sum_{i=1}^{t} \sum_{z\in O_i} \sum_{y\in \F_2^{n-n_w}}(-1)^{f(y,z)+by+cz}&= \frac{1}{2}\sum_{i=1}^{t} \sum_{z\in O_i} \sum_{y\in \F_2^{n-n_w}} \left((-1)^{f(y,z)+by+cz} + (-1)^{f(y,\pi_w(z))+by+c\pi_w(z)} \right)\\
&=\frac{1}{2}\sum_{i=1}^{t} \sum_{z\in O_i} \sum_{y\in \F_2^{n-n_w}} \left((-1)^{f(y,z)+by}  \right)\left( (-1)^{cz}-(-1)^{c \pi_w(z)}   \right)
\end{align*}

Accordingly, for each $z$ such that $cz=c\pi_w(z)$, the term is null in the summation. Thereafter:

\begin{align*}|\sum_{i=1}^{t} \sum_{z\in O_i} \sum_{y\in \F_2^{n-n_w}}(-1)^{f(y,z)+by+cz}|&=|\frac{1}{2}\sum_{i=1}^{t} \sum_{z\in O_i \atop {c(z+\pi_w(z))=1}} \sum_{y\in \F_2^{n-n_w}} \left((-1)^{f(y,z)+by}  \right)2(-1)^{cz}|\\
&\le 2^{n-n_w} |\{ z \in \F_2^{n_w} \setminus \{0_{n_w},1_{n_w}\},  c(z+\pi_w(z))=1   \}|
\end{align*}

Using Proposition~\ref{prop:setSize} it allows to conclude:
\[|\sum_{i=1}^{t} \sum_{z\in O_i} \sum_{y\in \F_2^{n-n_w}}(-1)^{f(y,z)+by+cz}|\le 2^{n-1},\]
and finally:
\begin{align*}
\NL(f)&\ge 2^{n-1}-\frac{1}{2} \max_{a\in \F_2^n}| \wt{f}(a)|\\
&\ge 2^{n-1}-\frac{1}{2} \left(2^{n-n_w+1} + 2^{n-1}\right)\\
&\ge 2^{n-2} - 2^{n-n_w}
\end{align*} 




\end{proof}


\pmnote{TODO: redact the proof of the proposition}

\begin{proposition}\label{prop:setSize}
	Let $n\ge 2$ be a power of $2$, and $\pi= (x_1,\ldots,x_n)$ the following holds:
\[ |\{ z \in \F_2^{n} \setminus \{0_{n},1_{n}\},  c(z+\pi(z))=1   \}| 
= \left \{
\begin{array}{l l}
	2^{n-1}  & \text{ if } c \in \F_2^n \setminus \{0_n,1_n\}, \\
	0  & \text{ if } c=0_n,\\
	0 & \text{ if } c=1_n.
\end{array}\right.\]
	
\end{proposition}
\begin{proof}
	
\end{proof}

\pmnote{Add the improvements on the nonlinearity bound, the formula in terms of sets for the $\NLk{k}$ and the generalizations to other subgroups.}





\ifnum\full=0
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\bibliographystyle{splncs04}
\bibliographystyle{alpha}
\bibliography{add}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\else
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliographystyle{alpha}
\bibliography{add}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\fi

\end{document}
